name: ğŸš€ Deploy GitHub Pages from Release ZIP

# 1. åœ¨ release å‘å¸ƒæ—¶è§¦å‘
on:
  release:
    types: [published]

permissions:
  contents: read    # è¯»å–ä»“åº“å†…å®¹
  pages: write      # æ¨é€åˆ° Pages
  id-token: write   # ç”¨äº OIDC èº«ä»½éªŒè¯

jobs:
  deploy:
    runs-on: ubuntu-latest

    # å¹¶å‘è®¾ç½®ï¼Œé¿å…é‡å¤éƒ¨ç½²å†²çª
    concurrency:
      group: "pages"
      cancel-in-progress: true

    steps:
      # ä¸‹è½½ Release ZIP èµ„äº§
      - name: Download release ZIP
        uses: dawidd6/action-download-release-asset@v2
        with:
          repository: ${{ github.repository }}
          tag: ${{ github.event.release.tag_name }}
          asset_name: WebGL_Demo.zip       # æ ¹æ®å®é™… ZIP åç§°è°ƒæ•´
          download_path: ./releases

      # è§£å‹ ZIP åˆ° output ç›®å½•
      - name: Extract site content
        run: |
          mkdir output
          unzip -q ./releases/site.zip -d output

      # ç¦ç”¨ Jekyll å¤„ç†ï¼šæ·»åŠ  .nojekyll æ–‡ä»¶
      - name: Disable Jekyll processing
        run: echo '' > output/.nojekyll

      # é…ç½® GitHub Pagesï¼ˆå¯ç”¨ Actions ä½œä¸ºå‘å¸ƒæºï¼‰
      - name: Configure Pages
        uses: actions/configure-pages@v5

      # ä¸Šä¼ è§£å‹åçš„é™æ€æ–‡ä»¶ï¼Œä½œä¸ºå‘å¸ƒå·¥ä»¶
      - name: Upload Pages artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: output

      # éƒ¨ç½²åˆ° GitHub Pages
      - name: Deploy to GitHub Pages
        uses: actions/deploy-pages@v4
